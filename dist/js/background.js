"use strict";(()=>{chrome.runtime.onMessage.addListener((e,r,o)=>{if(e.type==="inboxsdk__injectPageWorld"&&r.tab)if(chrome.scripting){let a,t;r.documentId?a=[r.documentId]:t=[r.frameId],chrome.scripting.executeScript({target:{tabId:r.tab.id,documentIds:a,frameIds:t},world:"MAIN",files:["pageWorld.js"]}),o(!0)}else o(!1)});chrome.runtime.onMessage.addListener((e,r,o)=>{if(e.action==="DOWNLOAD_FILE")try{if(!chrome.downloads)throw new Error("chrome.downloads API is not available");let a;try{let s=new TextEncoder().encode(e.data),c="";for(let l=0;l<s.length;l++)c+=String.fromCharCode(s[l]);a=btoa(c)}catch(n){throw new Error("Failed to encode data: "+n.message)}let t="data:application/json;base64,"+a;chrome.downloads.download({url:t,filename:e.filename,saveAs:!1,conflictAction:"uniquify"},n=>{chrome.runtime.lastError?o({success:!1,error:chrome.runtime.lastError.message}):o({success:!0,downloadId:n})})}catch(a){o({success:!1,error:a.message})}else e.action==="UNINSTALL_SELF"&&chrome.management&&chrome.management.uninstallSelf&&chrome.management.uninstallSelf({showConfirmDialog:!0},()=>{chrome.runtime.lastError});return!0});var i="https://tally.so/r/D4BBRR?transparentBackground=1&formEventsForwarding=1";chrome.runtime.setUninstallURL&&chrome.runtime.setUninstallURL(i,()=>{});chrome.action.onClicked.addListener(e=>{e.id&&chrome.tabs.sendMessage(e.id,{action:"TOGGLE_SETTINGS"}).catch(r=>{})});chrome.runtime.onInstalled.addListener(e=>{e.reason==="install"&&(chrome.tabs.create({url:"welcome.html"}),chrome.tabs.query({url:"https://mail.google.com/*"},r=>{r.forEach(o=>{o.id&&chrome.tabs.reload(o.id)})}))});})();
